<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Reporte Mensual</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1 {
            text-align: center;
        }

        .informe {
            border: 1px solid #000;
            padding: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .informe h2 {
            margin: 0;
        }

        .canvas-container {
            display: flex;
            justify-content: center; /* Centrar horizontalmente */
            align-items: center;
        }

        canvas {
            margin-right: 10px; /* Espacio entre los canvas */
        }

        @media print {
            body {
                margin: 0;
                padding: 0;
            }

            h1 {
                page-break-before: always;
            }

            .informe {
                page-break-inside: avoid;
            }
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', function () {

            var valdisponibilidad = ${reportedisponibbilidad};
            var valrendimiento = ${reporterendimiento};
            var valcalidad = ${reportecalidad};
            var valoee =parseInt((valrendimiento*valdisponibilidad*valcalidad)/10000);

            document.getElementById("titlereporte").innerHTML = "Reporte Mensual: " + ${reportefecha};
            document.getElementById("titleturno").innerHTML = "Turno: " + ${reporteturno};

            function drawPercentagedisponibilidad(chart) {
                var ctx = chart.chart.ctx;
                var width = (chart.chart.width);
                var height = (chart.chart.height)+35;
                var radius = Math.min(width, height) / 2; 
                var centerX = width / 2;
                var centerY = (height / 2);
                var fontSize = ((radius / 2).toFixed(0))-10; 
            
                var text = valdisponibilidad + "%";
            
                ctx.font = fontSize + "px sans-serif";
                ctx.fillStyle = "#000"; // Color del texto
                ctx.textBaseline = "middle";
                ctx.textAlign = "center";
            
                // posici贸n del texto en el centro del circulo
                var textX = centerX;
                var textY = centerY;
            
                ctx.fillText(text, textX, textY);
            }
        
            function drawPercentagerendimiento(chart) {
                var ctx = chart.chart.ctx;
                var width = (chart.chart.width);
                var height = (chart.chart.height)+35;
                var radius = Math.min(width, height) / 2; 
                var centerX = width / 2;
                var centerY = (height / 2);
                var fontSize = ((radius / 2).toFixed(0))-10; 
            
                var text = valrendimiento + "%";
            
                ctx.font = fontSize + "px sans-serif";
                ctx.fillStyle = "#000"; // Color del texto
                ctx.textBaseline = "middle";
                ctx.textAlign = "center";
            
                // posici贸n del texto en el centro del circulo
                var textX = centerX;
                var textY = centerY;
            
                ctx.fillText(text, textX, textY);
            }
                
            function drawPercentagecalidad(chart) {
                var ctx = chart.chart.ctx;
                var width = (chart.chart.width);
                var height = (chart.chart.height)+35;
                var radius = Math.min(width, height) / 2; 
                var centerX = width / 2;
                var centerY = (height / 2);
                var fontSize = ((radius / 2).toFixed(0))-10; 
            
                var text = valcalidad + "%";
            
                ctx.font = fontSize + "px sans-serif";
                ctx.fillStyle = "#000"; // Color del texto
                ctx.textBaseline = "middle";
                ctx.textAlign = "center";
            
                // posici贸n del texto en el centro del circulo
                var textX = centerX;
                var textY = centerY;
            
                ctx.fillText(text, textX, textY);
            }
        
            function drawPercentageoee(chart) {
                var ctx = chart.chart.ctx;
                var width = (chart.chart.width);
                var height = (chart.chart.height)+35;
                var radius = Math.min(width, height) / 2; 
                var centerX = width / 2;
                var centerY = (height / 2);
                var fontSize = ((radius / 2).toFixed(0))-10; 
            
                var text = valoee + "%";
            
                ctx.font = fontSize + "px sans-serif";
                ctx.fillStyle = "#000"; // Color del texto
                ctx.textBaseline = "middle";
                ctx.textAlign = "center";
            
                // posici贸n del texto en el centro del circulo
                var textX = centerX;
                var textY = centerY;
            
                ctx.fillText(text, textX, textY);
            }
            
            if (valdisponibilidad<=40) {
                var Disponibilidadcolor = ['#fd0100', '#e5e5e5'];
            } else if (valdisponibilidad>40 && valdisponibilidad<75) {
                var Disponibilidadcolor = ['#fffe06', '#e5e5e5'];            
            }else {
                var Disponibilidadcolor = ['#05fc03', '#e5e5e5'];
            }
    
            if (valrendimiento<=40) {
                var Rendimientocolor = ['#fd0100', '#e5e5e5'];
            } else if (valrendimiento>40 && valrendimiento<75) {
                var Rendimientocolor = ['#fffe06', '#e5e5e5'];            
            }else {
                var Rendimientocolor = ['#05fc03', '#e5e5e5'];
            }
    
            if (valcalidad<=40) {
                var Calidadcolor = ['#fd0100', '#e5e5e5'];
            } else if (valcalidad>40 && valcalidad<75) {
                var Calidadcolor = ['#fffe06', '#e5e5e5'];            
            }else {
                var Calidadcolor = ['#05fc03', '#e5e5e5'];
            }
    
            if (valoee<=40) {
                var OEEcolor = ['#fd0100', '#e5e5e5'];
            } else if (valoee>40 && valoee<75) {
                var OEEcolor = ['#fffe06', '#e5e5e5'];            
            }else {
                var OEEcolor = ['#05fc03', '#e5e5e5'];
            }


            var ctx1 = document.getElementById('Disponibilidad').getContext('2d');
            var myChart = new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: ['Disponibilidad'],
                    datasets: [{
                    data: [valdisponibilidad, 100-valdisponibilidad],
                    backgroundColor: Disponibilidadcolor,
                    }],
                },
                options: {
                    events: [],
                    responsive: false,
                    maintainAspectRatio: false,
                    tooltips: {
                        enabled: false,
                        },
                    animation: {
                        onComplete: function (chart) {
                            drawPercentagedisponibilidad(chart);
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Disponibilidad',
                            font: {weight: 'bold', size: 14},
                            color: '#2c4f63',
                        },
                        legend: {
                        display: false
                        }
                    },
        
                    borderWidth: 0,
                    cutout: 60,
                }
            });

            var ctx2 = document.getElementById('Rendimiento').getContext('2d');
            var myChart = new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    labels: ['Rendimiento'],
                    datasets: [{
                    data: [valrendimiento, 100-valrendimiento],
                    backgroundColor: Rendimientocolor,
                    }],
                },
                options: {
                    events: [],
                    responsive: false,
                    maintainAspectRatio: false,
                    tooltips: {
                        enabled: false,
                        },
                    animation: {
                        onComplete: function (chart) {
                            drawPercentagerendimiento(chart);
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Rendimiento',
                            font: {weight: 'bold', size: 14},
                            color: '#2c4f63',
                        },
                        legend: {
                        display: false
                        }
                    },
        
                    borderWidth: 0,
                    cutout: 60,
                }
            });

            var ctx3 = document.getElementById('Calidad').getContext('2d');
            var myChart = new Chart(ctx3, {
                type: 'doughnut',
                data: {
                    labels: ['Calidad'],
                    datasets: [{
                    data: [valcalidad, 100-valcalidad],
                    backgroundColor: Calidadcolor,
                    }],
                },
                options: {
                    events: [],
                    responsive: false,
                    maintainAspectRatio: false,
                    tooltips: {
                        enabled: false,
                        },
                    animation: {
                        onComplete: function (chart) {
                            drawPercentagecalidad(chart);
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Calidad',
                            font: {weight: 'bold', size: 14},
                            color: '#2c4f63',
                        },
                        legend: {
                        display: false
                        }
                    },
        
                    borderWidth: 0,
                    cutout: 60,
                }
            });

            var ctx4 = document.getElementById('OEE').getContext('2d');
            var myChart = new Chart(ctx4, {
                type: 'doughnut',
                data: {
                    labels: ['OEE'],
                    datasets: [{
                    data: [valoee, 100-valoee],
                    backgroundColor: OEEcolor,
                    }],
                },
                options: {
                    events: [],
                    responsive: false,
                    maintainAspectRatio: false,
                    tooltips: {
                        enabled: false,
                        },
                    animation: {
                        onComplete: function (chart) {
                            drawPercentageoee(chart);
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'OEE',
                            font: {weight: 'bold', size: 14},
                            color: '#2c4f63',
                        },
                        legend: {
                        display: false
                        }
                    },
        
                    borderWidth: 0,
                    cutout: 60,
                }
            });
        
        });
    </script>
</head>
<body>
    <h1 id="titlereporte"></h1> 
    <h2 id="titleturno" style="text-align: center;"></h2>

    <div class="informe">
        <h2>PARAMETROS</h2>
        <div class="canvas-container">
            <canvas id="Disponibilidad" width="200" height="200"></canvas>
            <canvas id="Rendimiento" width="200" height="200"></canvas>
            <canvas id="Calidad" width="200" height="200"></canvas>
        </div>
    </div>

    <div class="informe">
        <h2>OEE</h2>
            <div class="canvas-container">
                <canvas id="OEE" width="200" height="200"></canvas>
            </div>
    </div>

</body>
</html>
